<!DOCTYPE html>
<html>

<head>
    <title>API Cache</title>

    <style type="text/css">
        body {
            margin: 1em auto;
            max-width: 40em;
            width: 88%;
        }
    </style>
</head>

<body>

    <h1>API Cache</h1>
    <p><em><strong>The Scuttlebutt</strong>&mdash;the number one source for pirate news!</em></p>

    <div id="app">
        Loading...
    </div>

    <script>

        let app = document.querySelector('#app');

        let storageID = 'pirateCache';

        let renderNews = (data) => {
            if (data.articles.length < 1) {
                return;
            }

            app.innerHTML = data.articles.map((article) => {
                let html =
                    '<article>' +
                    '<h2>' + article.title + '</h2>' +
                    '<p><em>By ' + article.author + ' on ' + article.pubdate + '</em></p>' +
                    article.article +
                    '</article>';
                return html;
            }).join('') + '<p><em>Articles are from <a href="' + data.attribution.url + '">' + data.attribution.name + '</a></em></p>';
        };

        let fetchArticles = () => {
            fetch('https://vanillajsacademy.com/api/pirates.json').then((response) => {
                if (response.ok) {
                    return response.json();
                } else {
                    return Promise.reject(response)
                }
            }).then((data) => {
                renderNews(data);
            }).catch(() => {
                console.log('nie wysz≈Ço')
            })
        };

        fetchArticles();


    </script>
</body>

</html>